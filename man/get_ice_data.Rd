% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_ice_data.R
\name{get_ice_data}
\alias{get_ice_data}
\title{Get USDA RMA Insurance Control Elements (ICE) data}
\usage{
get_ice_data(
  years = NULL,
  dataset = NULL,
  ice_url =
    "https://pubfs-rma.fpac.usda.gov/pub/References/insurance_control_elements/PASS/",
  show_progress = TRUE,
  force = FALSE
)
}
\arguments{
\item{years}{Numeric vector. The year(s) of ICE data to retrieve. Can be a single year or vector of years.
When multiple years are provided, data is downloaded for each year and row-bound into a single data frame.}

\item{dataset}{Character. Either "metadata" to return file information, or keywords to filter
specific ICE datasets (e.g., "LegalDescription", "InsurancePlan"). Case-insensitive matching.
Must match exactly one file - multiple matches will throw an error since different ICE
datasets have incompatible column structures. Use get_ice_data(dataset = "metadata")
to explore available files first.}

\item{ice_url}{Character. Base URL for the ICE repository. Defaults to the public USDA RMA FTP URL.}

\item{show_progress}{Logical value indicating whether a progress download bar should be displayed. Defaults to TRUE.}

\item{force}{Logical (default FALSE). If TRUE, attempts to download fresh data regardless of cache,
but falls back to cached data on failure with a warning.}
}
\value{
If dataset = "metadata", returns a data frame with file information including filename, size,
date, and descriptions. Otherwise returns a data frame containing the requested ICE data.
}
\description{
Retrieves ICE data for specified years and datasets from the USDA RMA ICE repository.
The function can return metadata about available files or download and process actual data files.
Downloaded files are cached locally to avoid repeated downloads.
}
\details{
This function serves as the main interface for accessing ICE data. It:
\itemize{
\item Can return metadata about available files when dataset = "metadata"
\item Downloads and processes specific ICE datasets when dataset contains filter keywords
\item Caches downloaded files locally to avoid repeated downloads
\item Handles multiple years by combining data across years
\item Uses selective downloading to minimize bandwidth usage
}

ICE files contain insurance control elements such as legal descriptions, insurance plan details,
commodity information, and other regulatory data used in the Federal Crop Insurance Program.
}
\examples{
\dontrun{
# Get metadata for 2024 ICE files
ice_meta_2024 <- get_ice_data(years = 2024, dataset = "metadata")

# Get legal description data for 2024
legal_data <- get_ice_data(years = 2024, dataset = "LegalDescription")

# Get insurance plan data for multiple years
plan_data <- get_ice_data(years = c(2023, 2024), dataset = "InsurancePlan")

# Force fresh download of 2024 data
fresh_data <- get_ice_data(years = 2024, dataset = "LegalDescription", force = TRUE)
}

}
